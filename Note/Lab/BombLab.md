# BombLab

## 1.GDB åŸºç¡€

### 1. å¯åŠ¨ä¸è¿è¡Œ

```bash
gdb <program>
```

- `<program>` ï¼šä½ è¦è°ƒè¯•çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæ¯”å¦‚ `./bomb`ï¼‰ã€‚

åœ¨ gdb å†…è¿è¡Œï¼š

```gdb
run [args]
```

- `args` ï¼šä¼ ç»™ç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•°ï¼ˆBomb Lab é€šå¸¸æ²¡æœ‰ï¼‰ã€‚

- å¯ä»¥ç”¨ `< file` è®©ç¨‹åºä»æ–‡ä»¶è¯»å–è¾“å…¥ï¼Œä¾‹å¦‚ï¼š

  ```gdb
  run < input.txt
  ```

------

### 2. æ–­ç‚¹ï¼ˆbreakpointï¼‰

æ ¼å¼ï¼š

```gdb
break [location]
```

å¸¸è§ `location` å†™æ³•ï¼š

- `break function_name` â†’ åœ¨å‡½æ•°å…¥å£å¤„åœä¸‹
- `break *0xADDR` â†’ åœ¨æŒ‡å®šå†…å­˜åœ°å€åœä¸‹
- `break filename:line` â†’ åœ¨æŸæºæ–‡ä»¶æŸè¡Œåœä¸‹ï¼ˆéœ€è¦æœ‰æºç è°ƒè¯•ä¿¡æ¯ï¼‰

ç›¸å…³å‘½ä»¤ï¼š

```gdb
delete [num]   # åˆ é™¤æ–­ç‚¹ï¼ˆnum æ˜¯æ–­ç‚¹ç¼–å·ï¼Œä¸å†™å°±æ˜¯å…¨éƒ¨ï¼‰
info break     # æ˜¾ç¤ºæ‰€æœ‰æ–­ç‚¹
```

------

### 3. å•æ­¥æ‰§è¡Œ

- **æœºå™¨æŒ‡ä»¤çº§**ï¼ˆæœ€å¸¸ç”¨ï¼Œå› ä¸º Bomb Lab æ²¡æºç ï¼‰ï¼š

  ```gdb
  stepi (æˆ– si)     # æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼Œè¿›å…¥å‡½æ•°
  nexti (æˆ– ni)     # æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼Œé‡åˆ° call ä¸è¿›å…¥
  continue (æˆ– c)   # ç»§ç»­è¿è¡Œï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹
  ```

------

### 4. æŸ¥çœ‹å¯„å­˜å™¨

```gdb
info registers [reg ...]
```

- `[reg ...]` ï¼šå¯é€‰ï¼Œåˆ—å‡ºå…·ä½“å¯„å­˜å™¨åï¼ˆå¦‚ `rdi rsi rax`ï¼‰ã€‚ä¸å†™åˆ™æ˜¾ç¤ºæ‰€æœ‰ã€‚

```gdb
print $reg
```

- `$reg` ï¼šå¯„å­˜å™¨åï¼Œç”¨ `$` å¼•ç”¨ï¼ˆå¦‚ `$rax`ï¼‰ã€‚æ˜¾ç¤ºæ•´æ•°å€¼ã€‚

```gdb
x/s $reg
```

- `x` = examine å†…å­˜
- `/s` = æŒ‰ C å­—ç¬¦ä¸²æ˜¾ç¤ºï¼ˆä»å¯„å­˜å™¨é‡Œå–å‡ºåœ°å€å¹¶æ‰“å°å­—ç¬¦ä¸²ï¼‰
   ğŸ‘‰ å¸¸ç”¨äº `%rdi`ã€`%rsi`ï¼Œå› ä¸ºå®ƒä»¬å¸¸å¸¸å­˜å­—ç¬¦ä¸²åœ°å€ã€‚

------

### 5. æŸ¥çœ‹å†…å­˜

é€šç”¨è¯­æ³•ï¼š

```gdb
x/[N][F][U] <expr>
```

- `N` ï¼šè¦æ˜¾ç¤ºå¤šå°‘ä¸ªå•å…ƒï¼ˆé»˜è®¤ 1ï¼‰
- `F` ï¼šæ˜¾ç¤ºæ ¼å¼
  - `x` (åå…­è¿›åˆ¶), `d` (åè¿›åˆ¶), `s` (å­—ç¬¦ä¸²), `i` (åæ±‡ç¼–æŒ‡ä»¤)
- `U` ï¼šå•å…ƒå¤§å°
  - `b` (å­—èŠ‚), `h` (2 å­—èŠ‚), `w` (4 å­—èŠ‚), `g` (8 å­—èŠ‚)
- `<expr>` ï¼šåœ°å€æˆ–å¯„å­˜å™¨è¡¨è¾¾å¼

ä¾‹å­ï¼š

```gdb
x/16gx $rsp   # æŸ¥çœ‹æ ˆé¡¶16ä¸ª8å­—èŠ‚
x/s 0x402400  # æŠŠ0x402400å¤„å†…å®¹å½“å­—ç¬¦ä¸²æ˜¾ç¤º
x/4i $rip     # ä»ripå¼€å§‹åæ±‡ç¼–4æ¡æŒ‡ä»¤
```

------

### 6. åæ±‡ç¼–

```gdb
disassemble [function | addr[,addr]]
```

- `function` ï¼šå‡½æ•°åï¼ˆå¦‚ `disas phase_2`ï¼‰
- `addr` ï¼šåœ°å€èŒƒå›´ï¼ˆå¦‚ `disas 0x400f50,0x400f80`ï¼‰

------

### 7. è‡ªåŠ¨åŒ–å‘½ä»¤ï¼ˆå¯é€‰ï¼‰

ç»™æ–­ç‚¹åŠ åŠ¨ä½œï¼š

```gdb
commands [breakpoint-number]
  [command-list]
end
```

ä¾‹å¦‚ï¼š

```gdb
break phase_1
commands
  silent
  x/s $rdi
  x/s $rsi1. å¯åŠ¨ä¸è¿è¡Œ
  continue
end
```

ğŸ‘‰ æ¯æ¬¡åœåœ¨ `phase_1` æ—¶ï¼Œè‡ªåŠ¨æ˜¾ç¤ºè¾“å…¥å’Œç­”æ¡ˆï¼Œå†ç»§ç»­è¿è¡Œã€‚

------

### æ€»ç»“

Bomb Lab çš„ gdb å¿…å¤‡æŒ‡ä»¤ï¼ˆæ ¼å¼åŒ–è®°å¿†ç‰ˆï¼‰ï¼š

1. `break location` â†’ ä¸‹æ–­ç‚¹
2. `stepi / nexti / continue` â†’ å•æ­¥ / ç»§ç»­
3. `info registers [reg...]` â†’ çœ‹å¯„å­˜å™¨
4. `print $reg` â†’ æ‰“å°å¯„å­˜å™¨å€¼
5. `x/[N][F][U] expr` â†’ æŸ¥çœ‹å†…å­˜/å­—ç¬¦ä¸²/æŒ‡ä»¤
6. `disassemble [func|addr]` â†’ åæ±‡ç¼–å‡½æ•°

## 2.Bomb

















